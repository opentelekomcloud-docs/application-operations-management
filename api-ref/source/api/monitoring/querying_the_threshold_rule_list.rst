:original_name: ListAlarmRule.html

.. _ListAlarmRule:

Querying the Threshold Rule List
================================

Function
--------

This API is used to query the threshold rule list.

URI
---

GET /v2/{project_id}/alarm-rules

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+-------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                   |
   +============+===========+========+===============================================================================+
   | project_id | Yes       | String | Project ID obtained from IAM. Generally, a project ID contains 32 characters. |
   +------------+-----------+--------+-------------------------------------------------------------------------------+

.. table:: **Table 2** Query Parameters

   +-----------+-----------+---------+-------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type    | Description                                                                   |
   +===========+===========+=========+===============================================================================+
   | offset    | No        | String  | Pagination information.                                                       |
   +-----------+-----------+---------+-------------------------------------------------------------------------------+
   | limit     | No        | Integer | Maximum number of returned records. Value range: 1-1000. Default value: 1000. |
   +-----------+-----------+---------+-------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +-----------------+-----------------+-----------------+------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                              |
   +=================+=================+=================+==========================================+
   | X-Auth-Token    | Yes             | String          | User token obtained from IAM.            |
   +-----------------+-----------------+-----------------+------------------------------------------+
   | Content-Type    | Yes             | String          | Content type, which is application/json. |
   |                 |                 |                 |                                          |
   |                 |                 |                 | Enumeration values:                      |
   |                 |                 |                 |                                          |
   |                 |                 |                 | -  **application/json**                  |
   +-----------------+-----------------+-----------------+------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +------------+-------------------------------------------------------------------------------------+-----------------------------------------------------+
   | Parameter  | Type                                                                                | Description                                         |
   +============+=====================================================================================+=====================================================+
   | meta_data  | :ref:`MetaData <listalarmrule__response_metadata>` object                           | Metadata, including pagination information.         |
   +------------+-------------------------------------------------------------------------------------+-----------------------------------------------------+
   | thresholds | Array of :ref:`QueryAlarmResult <listalarmrule__response_queryalarmresult>` objects | Parameters specified for querying a threshold rule. |
   +------------+-------------------------------------------------------------------------------------+-----------------------------------------------------+

.. _listalarmrule__response_metadata:

.. table:: **Table 5** MetaData

   +-----------+---------+---------------------------------------------------------------------------+
   | Parameter | Type    | Description                                                               |
   +===========+=========+===========================================================================+
   | count     | Integer | Number of returned records.                                               |
   +-----------+---------+---------------------------------------------------------------------------+
   | start     | String  | Start of the next page, which is used for pagination. null: No more data. |
   +-----------+---------+---------------------------------------------------------------------------+
   | total     | Integer | Total number of records.                                                  |
   +-----------+---------+---------------------------------------------------------------------------+

.. _listalarmrule__response_queryalarmresult:

.. table:: **Table 6** QueryAlarmResult

   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | Parameter                 | Type                                                                  | Description                              |
   +===========================+=======================================================================+==========================================+
   | action_enabled            | Boolean                                                               | Whether to enable notification.          |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | alarm_actions             | Array of strings                                                      | List of alarm notifications.             |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | alarm_advice              | String                                                                | Alarm clearance suggestion.              |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | alarm_description         | String                                                                | Threshold rule description.              |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | alarm_level               | String                                                                | Alarm severity.                          |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | alarm_rule_id             | String                                                                | Threshold rule ID.                       |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | alarm_rule_name           | String                                                                | Threshold rule name.                     |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | comparison_operator       | String                                                                | Comparison operator.                     |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | dimensions                | Array of :ref:`Dimension <listalarmrule__response_dimension>` objects | List of time series dimensions.          |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | evaluation_periods        | Integer                                                               | Interval.                                |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | id_turn_on                | Boolean                                                               | Whether to enable the threshold rule.    |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | insufficient_data_actions | Array of strings                                                      | List of insufficient data notifications. |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | metric_name               | String                                                                | Time series name.                        |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | namespace                 | String                                                                | Time series objects' namespace.          |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | ok_actions                | Array of strings                                                      | List of normal status notifications.     |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | period                    | Integer                                                               | Statistical period.                      |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | policy_name               | String                                                                | Threshold rule name.                     |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | resources                 | Array of strings                                                      | Resource information (discarded).        |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | state_reason              | String                                                                | Cause description.                       |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | state_updated_timestamp   | String                                                                | Time when the status was updated.        |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | state_value               | String                                                                | Service status.                          |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | statistic                 | String                                                                | Statistic.                               |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | threshold                 | String                                                                | Threshold value.                         |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | type                      | String                                                                | Threshold rule type.                     |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+
   | unit                      | String                                                                | Threshold unit.                          |
   +---------------------------+-----------------------------------------------------------------------+------------------------------------------+

.. _listalarmrule__response_dimension:

.. table:: **Table 7** Dimension

   ========= ====== ================
   Parameter Type   Description
   ========= ====== ================
   name      String Dimension name.
   value     String Dimension value.
   ========= ====== ================

**Status code: 400**

.. table:: **Table 8** Response body parameters

   +------------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Type   | Description                                                                                                                                         |
   +============+========+=====================================================================================================================================================+
   | error_code | String | Error code.                                                                                                                                         |
   +------------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
   | error_msg  | String | Error message.                                                                                                                                      |
   +------------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
   | error_type | String | Error type.                                                                                                                                         |
   +------------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
   | trace_id   | String | Trace ID, which is used to search for logs and locate faults. If **2xx** is returned, **trace_id** is empty. If **4xx**, **trace_id** is not empty. |
   +------------+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+

Example Requests
----------------

Obtain the alarm rule list of a user whose ID is **Project_Id**.

.. code-block::

   https://{EndPoint}/v2/{Project_Id}/alarm-rules

Example Responses
-----------------

**Status code: 200**

OK: The request is successful.

.. code-block::

   {
     "meta_data" : [ {
       "count" : 10,
       "total" : 100
     } ],
     "thresholds" : [ {
       "action_enable" : false,
       "alarm_actions" : null,
       "alarm_advice" : null,
       "alarm_description" : null,
       "alarm_level" : 3,
       "alarm_rule_id" : 2137,
       "alarm_rule_name" : "aom_rule",
       "comparison_operator" : ">=",
       "dimensions" : [ {
         "name" : "appName"
       }, {
         "value" : "rhm-broker"
       } ],
       "evaluation_periods" : 1,
       "id_turn_on" : true,
       "insufficient_data_actions" : null,
       "metric_name" : "cpuCoreLimit",
       "namespace" : "PAAS.CONTAINER",
       "ok_actions" : null,
       "period" : 60000,
       "policy_name" : "23,",
       "resources" : [ ],
       "state_reason" : null,
       "state_updated_timestamp" : null,
       "state_value" : "alarm",
       "statistic" : "average",
       "threshold" : 0,
       "type" : "single,",
       "unit" : "Core"
     } ]
   }

**Status code: 400**

Bad Request: The request is invalid. The client should not repeat the request without modifications.

.. code-block::

   {
     "error_code" : "AOM.02001AOM.02001SVCSTG_AMS_4000115",
     "error_msg" : "please check request param",
     "error_type" : "BAD_REQUEST",
     "trace_id" : ""
   }

Status Codes
------------

+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Status Code | Description                                                                                                                                                                                         |
+=============+=====================================================================================================================================================================================================+
| 200         | OK: The request is successful.                                                                                                                                                                      |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 400         | Bad Request: The request is invalid. The client should not repeat the request without modifications.                                                                                                |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 401         | Unauthorized: The authentication information is incorrect or invalid.                                                                                                                               |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 403         | Forbidden: The request is rejected. The server has received the request and understood it, but the server refuses to respond to it. The client should not repeat the request without modifications. |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 500         | Internal Server Error: The server is able to receive the request but unable to understand the request.                                                                                              |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 503         | Service Unavailable: The requested service is invalid. The client should not repeat the request without modifications.                                                                              |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
